<!-- 














  ** DO NOT EDIT THIS FILE
  ** 
  ** This file was automatically generated by the `build-harness`. 
  ** 1) Make all changes to `README.yaml` 
  ** 2) Run `make init` (you only need to do this once)
  ** 3) Run`make readme` to rebuild this file. 
  **
  ** (We maintain HUNDREDS of open source projects. This is how we maintain our sanity.)
  **















  -->

[![Carnegie Robotics, LLC][logo]](https://carnegierobotics.com)

# terraform-aws-concourse-ec2-worker


Terraform module for deploying a Concourse EC2 worker ASG.


---







## Usage


**IMPORTANT:** The `master` branch is used in `source` just as an example. In your code, do not pin to `master` because there may be breaking changes between releases.
Instead pin to the release tag (e.g. `?ref=tags/x.y.z`) of one of our [latest releases](https://github.com/carnegierobotics/terraform-aws-concourse-ec2-worker/releases).



TODO






<!-- markdownlint-disable -->
## Makefile Targets
```text
Available targets:

  help                                Help screen
  help/all                            Display help for all targets
  help/short                          This help short screen

```
<!-- markdownlint-restore -->
<!-- markdownlint-disable -->
## Requirements

| Name | Version |
|------|---------|
| terraform | ~> 0.12.0 |
| aws | ~> 2.0 |
| local | ~> 1.3 |

## Providers

| Name | Version |
|------|---------|
| aws | ~> 2.0 |
| local | ~> 1.3 |
| template | n/a |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| additional\_security\_group\_ids | Additional security group ids to attach to the worker instances | `list(string)` | `[]` | no |
| associate\_public\_ip\_address | Boolean flag to enable / disable public IPs for network interfaces | `bool` | `false` | no |
| attributes | Additional attributes (e.g. `1`) | `list(string)` | `[]` | no |
| concourse\_tags | List of tags to add to the worker to use for assigning jobs and tasks | `list(string)` | `[]` | no |
| concourse\_tsa\_hostname | Hostname where Concourse will be available (NLB). | `string` | n/a | yes |
| concourse\_version | Concourse CI version to use. Defaults to the latest tested version | `string` | `"5.8.0"` | no |
| concourse\_worker\_dns\_servers | DNS server list | `list(string)` | <pre>[<br>  "8.8.8.8",<br>  "8.8.4.4"<br>]</pre> | no |
| concourse\_worker\_max\_count | Min number of Concourse worker instances | `number` | `1` | no |
| concourse\_worker\_min\_count | Min number of Concourse worker instances | `number` | `1` | no |
| cpu\_credits | The credit option for CPU usage. Can be `standard` or `unlimited` | `string` | `"standard"` | no |
| cross\_account\_worker\_role\_arn | IAM role ARN to assume to access the Concourse keys bucket in another AWS account | `string` | `null` | no |
| delimiter | Delimiter to be used between `namespace`, `stage`, `name` and `attributes` | `string` | `"-"` | no |
| instance\_type | EC2 instance type for the worker instances | `string` | `"t3.medium"` | no |
| keys\_bucket\_arn | The S3 bucket ARN which contains the SSH keys to connect to the TSA | `string` | n/a | yes |
| keys\_bucket\_id | The S3 bucket id which contains the SSH keys to connect to the TSA | `string` | n/a | yes |
| name | Application or solution name (e.g. `app`) | `string` | `"concourse"` | no |
| namespace | Namespace (e.g. `cp` or `cloudposse`) | `string` | n/a | yes |
| region | AWS Region for S3 bucket | `string` | n/a | yes |
| root\_disk\_volume\_size | Size of the worker instances root disk | `string` | `"10"` | no |
| root\_disk\_volume\_type | Volume type of the worker instances root disk | `string` | `"gp2"` | no |
| ssh\_key\_name | The key name to use for the instance | `string` | `""` | no |
| stage | Stage (e.g. `prod`, `dev`, `staging`) | `string` | n/a | yes |
| subnet\_ids | List of subnet ids where to deploy the worker instances | `list(string)` | n/a | yes |
| tags | Additional tags (e.g. map(`BusinessUnit`,`XYZ`) | `map(string)` | `{}` | no |
| vpc\_id | The VPC id where to deploy the worker instances | `string` | n/a | yes |
| work\_disk\_device\_name | Device name of the external EBS volume to use as Concourse worker storage | `string` | `"/dev/sdf"` | no |
| work\_disk\_ephemeral | Whether to use ephemeral volumes as Concourse worker storage. You must use an [`instance_type` that supports this](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html#InstanceStoreDeviceNames) | `string` | `false` | no |
| work\_disk\_internal\_device\_name | Device name of the internal volume as identified by the Linux kernel, which can differ from `work_disk_device_name` depending on used AMI. Make sure this is set according the `instance_type`, eg. `/dev/xvdf` when using an older AMI | `string` | `"/dev/nvme1n1"` | no |
| work\_disk\_volume\_size | Size of the external EBS volume to use as Concourse worker storage | `string` | `"100"` | no |
| work\_disk\_volume\_type | Volume type of the external EBS volume to use as Concourse worker storage | `string` | `"gp2"` | no |
| worker\_tsa\_port | TSA port that the worker can use to connect to the web | `number` | `2222` | no |

## Outputs

| Name | Description |
|------|-------------|
| worker\_iam\_role | Role name of the worker instances |
| worker\_iam\_role\_arn | Role ARN of the worker instances |
| worker\_security\_group\_id | Security group ID used for the worker instances |

<!-- markdownlint-restore -->



## Related Projects

Check out these related projects.

- [terraform-aws-concourse-web](https://github.com/carnegierobotics/terraform-aws-concourse-web) - Terraform module for deploying Concourse on ECS
- [terraform-aws-concourse-keys-s3](https://github.com/carnegierobotics/terraform-aws-concourse-keys-s3) - Terraform module for deploying Concourse TLS / SSH keys to S3
- [terraform-aws-concourse-sidecred-lambda](https://github.com/carnegierobotics/terraform-aws-concourse-sidecred-lambda) - Terraform module to create a sidecred lambda for injecting and rotating credentials into SSM
- [terraform-root-modules](https://github.com/carnegierobotics/terraform-root-modules) - Terraform root modules to provision top level account



## Contributing

### Bug Reports & Feature Requests

Please use the [issue tracker](https://github.com/carnegierobotics/terraform-aws-concourse-ec2-worker/issues) to report any bugs or file feature requests.

### Developing

In general, PRs are welcome. We follow the typical "fork-and-pull" Git workflow.

 1. **Fork** the repo on GitHub
 2. **Clone** the project to your own machine
 3. **Commit** changes to your own branch
 4. **Push** your work back up to your fork
 5. Submit a **Pull Request** so that we can review your changes

**NOTE:** Be sure to merge the latest changes from "upstream" before making a pull request!



## Copyrights

Copyright © 2017-2021 [Cloud Posse, LLC](https://cpco.io/copyright)

Copyright © 2020-2021 [Carnegie Robotics, LLC](https://carnegierobotics.com/)







## Trademarks

All other trademarks referenced herein are the property of their respective owners.

## About

This project is maintained and funded by [Carnegie Robotics, LLC][website].

[logo]: https://static1.squarespace.com/static/503b9985e4b04953d0f47479/t/5c9a2d3e8d1d4f0001a28973/1582047053643/?format=1500w
  [docs]: https://carnegierobotics.com?utm_source=github&utm_medium=readme&utm_campaign=carnegierobotics/terraform-aws-concourse-ec2-worker&utm_content=docs
  [website]: https://carnegierobotics.com?utm_source=github&utm_medium=readme&utm_campaign=carnegierobotics/terraform-aws-concourse-ec2-worker&utm_content=website
  [github]: https://github.com/carnegierobotics?utm_source=github&utm_medium=readme&utm_campaign=carnegierobotics/terraform-aws-concourse-ec2-worker&utm_content=github
